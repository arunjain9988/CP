{"task_url":"https://www.codechef.com/LTIME85B/problems/RESTCH","statement":{"HTML":{"html":"\n<html>\n\t<head>\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css\">\n\t\t<script type=\"text/x-mathjax-config\">\n\t\t\tMathJax.Hub.Config({\n\t\t\t\ttex2jax: {inlineMath: [['$','$']]}\n\t\t\t});\n\t\t</script>\n\t\t<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>\n\t\t<style>\n\t\t\t.markdown-body {\n\t\t\t\tbackground-color: white;\n\t\t\t\tpadding-bottom: 20px;\n\t\t\t}\n\t\t\t.markdown-body code {\n\t\t\t\tcolor: #24292e;\n\t\t\t}\n\t\t\t.solution-visible-txt {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t</style>\n\t</head>\n\t<body class=\"markdown-body\">\n\t\t<h1>Chef, Chefina and Restoration</h1>\n<h3>Read problem statements in <a href=\"http://www.codechef.com/download/translated/LTIME85/hindi/RESTCH.pdf\">Hindi</a>, <a href=\"http://www.codechef.com/download/translated/LTIME85/bengali/RESTCH.pdf\">Bengali</a>, <a href=\"http://www.codechef.com/download/translated/LTIME85/mandarin/RESTCH.pdf\">Mandarin Chinese</a>, <a href=\"http://www.codechef.com/download/translated/LTIME85/russian/RESTCH.pdf\">Russian</a>, and <a href=\"http://www.codechef.com/download/translated/LTIME85/vietnamese/RESTCH.pdf\">Vietnamese</a> as well.</h3>\n<p>Chefina gave Chef a sequence $F_1, F_2, \\ldots, F_N$ as a birthday present. She constructed it from a sequence of positive integers $A_1, A_2, \\ldots, A_N$ in the following way: for each valid $i$, $F_i = \\sum_{j=1}^i (-1)^{(j+1)} \\cdot A_j$.</p>\n<p>Unfortunately, Chef was playing with the sequence $F$ and shuffled it. Now, he has a sequence denoted by $B$, but he does not remember $F$. The only things he knows are that $F$ is a permutation of $B$ and among all such permutations which Chefina could have constructed, her sequence $F$ was the lexicographically smallest.</p>\n<p>Chef does not want to disappoint Chefina, but he is too busy in the kitchen, so he asked you to help him recover $F$. Find the sequence $F$ he got from Chefina or determine that he made another mistake and a sequence that satisfies the given conditions does not exist.</p>\n<h3>Input</h3>\n<ul>\n<li>The first line of the input contains a single integer $T$ denoting the number of test cases. The description of $T$ test cases follows.</li>\n<li>The first line of each test case contains a single integer $N$.</li>\n<li>The second line contains $N$ space-separated integers $B_1, B_2, \\ldots, B_N$.</li>\n</ul>\n<h3>Output</h3>\n<p>For each test case:</p>\n<ul>\n<li>If there is no solution, print a single line containing the string <code>&quot;NO&quot;</code> (without quotes).</li>\n<li>Otherwise, print two lines.</li>\n<li>The first of these lines should contain the string <code>&quot;YES&quot;</code> (without quotes).</li>\n<li>The second line should contain $N$ space-separated integers $F_1, F_2, \\ldots, F_N$.</li>\n</ul>\n<h3>Constraints</h3>\n<ul>\n<li>$1 \\le T \\le 10,000$</li>\n<li>$1 \\le N \\le 10^5$</li>\n<li>$|B_i| \\le 10^9$ for each valid $i$</li>\n<li>the sum of $N$ over all test cases does not exceed $10^6$</li>\n</ul>\n<h3>Subtasks</h3>\n<p><strong>Subtask #1 (50 points):</strong> $B_1, B_2, \\ldots, B_N$ are pairwise distinct</p>\n<p><strong>Subtask #2 (50 points):</strong> original constraints</p>\n<h3>Example Input</h3>\n<pre><code>4\n2\n1 2\n3\n-1 -2 -3\n4\n3 3 3 4\n4\n4 -4 4 -4\n</code></pre>\n<h3>Example Output</h3>\n<pre><code>YES\n2 1\nNO\nNO\nYES\n4 -4 4 -4\n</code></pre>\n<h3>Explanation</h3>\n<p><strong>Example case 1:</strong> The only two permutations of $B$ are $[1,2]$ and $[2,1]$. Out of them, $[1,2]$ could not have been generated by Chefina, since it would require $A = [1,-1]$, which contains a negative element. On the other hand, for $[2,1]$, we get $A = [2,1]$, so $F = [2,1]$ must be the sequence Chefina generated.</p>\n\n\t<body>\n</html>"}}}